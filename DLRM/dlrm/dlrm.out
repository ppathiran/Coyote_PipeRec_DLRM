Running with mini-batch size: 4096
Running with num-workers: 4
Iteration 1 for mini-batch size 4096 and num-workers 4
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=4096 --num-workers=4 --use-gpu 2>&1 | tee run_kaggle_pt_batch_4096_workers_4_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/9593 of epoch 0, 9.64 ms/it, loss 0.558687
Finished training it 200/9593 of epoch 0, 7.78 ms/it, loss 0.522988
Finished training it 300/9593 of epoch 0, 8.11 ms/it, loss 0.517241
Finished training it 400/9593 of epoch 0, 7.82 ms/it, loss 0.515488
Finished training it 500/9593 of epoch 0, 8.16 ms/it, loss 0.514028
Finished training it 600/9593 of epoch 0, 7.73 ms/it, loss 0.512832
Finished training it 700/9593 of epoch 0, 7.76 ms/it, loss 0.511588
Finished training it 800/9593 of epoch 0, 7.62 ms/it, loss 0.509478
Finished training it 900/9593 of epoch 0, 8.02 ms/it, loss 0.506095
Finished training it 1000/9593 of epoch 0, 8.38 ms/it, loss 0.507013
Finished training it 1100/9593 of epoch 0, 8.24 ms/it, loss 0.506320
Finished training it 1200/9593 of epoch 0, 8.51 ms/it, loss 0.505054
Finished training it 1300/9593 of epoch 0, 7.54 ms/it, loss 0.505339
Finished training it 1400/9593 of epoch 0, 5.73 ms/it, loss 0.503303
Finished training it 1500/9593 of epoch 0, 7.83 ms/it, loss 0.503260
Finished training it 1600/9593 of epoch 0, 8.53 ms/it, loss 0.500545
Finished training it 1700/9593 of epoch 0, 8.75 ms/it, loss 0.502940
Finished training it 1800/9593 of epoch 0, 7.29 ms/it, loss 0.497773
Finished training it 1900/9593 of epoch 0, 6.72 ms/it, loss 0.499518
Finished training it 2000/9593 of epoch 0, 8.35 ms/it, loss 0.499091
Finished training it 2100/9593 of epoch 0, 8.27 ms/it, loss 0.498464
Finished training it 2200/9593 of epoch 0, 8.18 ms/it, loss 0.496102
Finished training it 2300/9593 of epoch 0, 8.01 ms/it, loss 0.495277
Finished training it 2400/9593 of epoch 0, 6.65 ms/it, loss 0.494015
Finished training it 2500/9593 of epoch 0, 6.93 ms/it, loss 0.492027
Finished training it 2600/9593 of epoch 0, 7.75 ms/it, loss 0.492307
Finished training it 2700/9593 of epoch 0, 8.31 ms/it, loss 0.492851
Finished training it 2800/9593 of epoch 0, 8.63 ms/it, loss 0.491358
Finished training it 2900/9593 of epoch 0, 7.20 ms/it, loss 0.490851
Finished training it 3000/9593 of epoch 0, 7.63 ms/it, loss 0.488265
Finished training it 3100/9593 of epoch 0, 7.88 ms/it, loss 0.486739
Finished training it 3200/9593 of epoch 0, 8.55 ms/it, loss 0.488761
Finished training it 3300/9593 of epoch 0, 8.07 ms/it, loss 0.485811
Finished training it 3400/9593 of epoch 0, 8.45 ms/it, loss 0.485610
Finished training it 3500/9593 of epoch 0, 8.23 ms/it, loss 0.486722
Finished training it 3600/9593 of epoch 0, 7.93 ms/it, loss 0.484789
Finished training it 3700/9593 of epoch 0, 8.32 ms/it, loss 0.483074
Finished training it 3800/9593 of epoch 0, 7.48 ms/it, loss 0.482445
Finished training it 3900/9593 of epoch 0, 6.36 ms/it, loss 0.481931
Finished training it 4000/9593 of epoch 0, 6.94 ms/it, loss 0.482148
Finished training it 4100/9593 of epoch 0, 7.84 ms/it, loss 0.482073
Finished training it 4200/9593 of epoch 0, 8.23 ms/it, loss 0.480636
Finished training it 4300/9593 of epoch 0, 8.50 ms/it, loss 0.477835
Finished training it 4400/9593 of epoch 0, 8.33 ms/it, loss 0.480396
Finished training it 4500/9593 of epoch 0, 7.75 ms/it, loss 0.475013
Finished training it 4600/9593 of epoch 0, 6.53 ms/it, loss 0.477703
Finished training it 4700/9593 of epoch 0, 7.61 ms/it, loss 0.474588
Finished training it 4800/9593 of epoch 0, 7.94 ms/it, loss 0.474997
Finished training it 4900/9593 of epoch 0, 8.43 ms/it, loss 0.475459
Finished training it 5000/9593 of epoch 0, 7.75 ms/it, loss 0.474578
Finished training it 5100/9593 of epoch 0, 8.38 ms/it, loss 0.474988
Finished training it 5200/9593 of epoch 0, 7.71 ms/it, loss 0.473151
Finished training it 5300/9593 of epoch 0, 8.35 ms/it, loss 0.475483
Finished training it 5400/9593 of epoch 0, 7.10 ms/it, loss 0.471724
Finished training it 5500/9593 of epoch 0, 7.46 ms/it, loss 0.472159
Finished training it 5600/9593 of epoch 0, 7.17 ms/it, loss 0.471474
Finished training it 5700/9593 of epoch 0, 7.15 ms/it, loss 0.472054
Finished training it 5800/9593 of epoch 0, 7.56 ms/it, loss 0.473305
Finished training it 5900/9593 of epoch 0, 8.76 ms/it, loss 0.470667
Finished training it 6000/9593 of epoch 0, 8.64 ms/it, loss 0.470601
Finished training it 6100/9593 of epoch 0, 8.79 ms/it, loss 0.471903
Finished training it 6200/9593 of epoch 0, 7.36 ms/it, loss 0.471275
Finished training it 6300/9593 of epoch 0, 7.70 ms/it, loss 0.470383
Finished training it 6400/9593 of epoch 0, 7.71 ms/it, loss 0.467559
Finished training it 6500/9593 of epoch 0, 8.88 ms/it, loss 0.468268
Finished training it 6600/9593 of epoch 0, 8.36 ms/it, loss 0.468257
Finished training it 6700/9593 of epoch 0, 8.51 ms/it, loss 0.467077
Finished training it 6800/9593 of epoch 0, 8.73 ms/it, loss 0.468153
Finished training it 6900/9593 of epoch 0, 7.81 ms/it, loss 0.465881
Finished training it 7000/9593 of epoch 0, 7.53 ms/it, loss 0.468683
Finished training it 7100/9593 of epoch 0, 5.85 ms/it, loss 0.467601
Finished training it 7200/9593 of epoch 0, 5.72 ms/it, loss 0.465525
Finished training it 7300/9593 of epoch 0, 5.63 ms/it, loss 0.467782
Finished training it 7400/9593 of epoch 0, 5.89 ms/it, loss 0.468188
Finished training it 7500/9593 of epoch 0, 8.67 ms/it, loss 0.467768
Finished training it 7600/9593 of epoch 0, 9.02 ms/it, loss 0.465873
Finished training it 7700/9593 of epoch 0, 8.70 ms/it, loss 0.466022
Finished training it 7800/9593 of epoch 0, 8.15 ms/it, loss 0.465104
Finished training it 7900/9593 of epoch 0, 8.16 ms/it, loss 0.465847
Finished training it 8000/9593 of epoch 0, 8.37 ms/it, loss 0.465480
Finished training it 8100/9593 of epoch 0, 8.92 ms/it, loss 0.463829
Finished training it 8200/9593 of epoch 0, 8.96 ms/it, loss 0.465896
Finished training it 8300/9593 of epoch 0, 6.55 ms/it, loss 0.464554
Finished training it 8400/9593 of epoch 0, 6.23 ms/it, loss 0.465405
Finished training it 8500/9593 of epoch 0, 7.15 ms/it, loss 0.461259
Finished training it 8600/9593 of epoch 0, 8.07 ms/it, loss 0.466216
Finished training it 8700/9593 of epoch 0, 8.15 ms/it, loss 0.464401
Finished training it 8800/9593 of epoch 0, 8.21 ms/it, loss 0.464606
Finished training it 8900/9593 of epoch 0, 7.39 ms/it, loss 0.462875
Finished training it 9000/9593 of epoch 0, 6.41 ms/it, loss 0.462342
Finished training it 9100/9593 of epoch 0, 6.15 ms/it, loss 0.463538
Finished training it 9200/9593 of epoch 0, 7.68 ms/it, loss 0.463627
Finished training it 9300/9593 of epoch 0, 8.49 ms/it, loss 0.463256
Finished training it 9400/9593 of epoch 0, 8.32 ms/it, loss 0.463717
Finished training it 9500/9593 of epoch 0, 6.91 ms/it, loss 0.463607
Finished training it 9593/9593 of epoch 0, 6.47 ms/it, loss 0.463364
Time to train:  349.4987907409668
Finished iteration 1 for mini-batch size: 4096 and num-workers: 4


Running with num-workers: 8
Iteration 1 for mini-batch size 4096 and num-workers 8
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=4096 --num-workers=8 --use-gpu 2>&1 | tee run_kaggle_pt_batch_4096_workers_8_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/9593 of epoch 0, 6.20 ms/it, loss 0.558688
Finished training it 200/9593 of epoch 0, 4.72 ms/it, loss 0.522989
Finished training it 300/9593 of epoch 0, 4.82 ms/it, loss 0.517241
Finished training it 400/9593 of epoch 0, 4.73 ms/it, loss 0.515487
Finished training it 500/9593 of epoch 0, 4.79 ms/it, loss 0.514027
Finished training it 600/9593 of epoch 0, 4.76 ms/it, loss 0.512817
Finished training it 700/9593 of epoch 0, 4.70 ms/it, loss 0.511596
Finished training it 800/9593 of epoch 0, 4.79 ms/it, loss 0.509503
Finished training it 900/9593 of epoch 0, 4.75 ms/it, loss 0.506116
Finished training it 1000/9593 of epoch 0, 4.77 ms/it, loss 0.507090
Finished training it 1100/9593 of epoch 0, 4.73 ms/it, loss 0.506464
Finished training it 1200/9593 of epoch 0, 4.68 ms/it, loss 0.505009
Finished training it 1300/9593 of epoch 0, 4.71 ms/it, loss 0.505294
Finished training it 1400/9593 of epoch 0, 4.71 ms/it, loss 0.503301
Finished training it 1500/9593 of epoch 0, 4.77 ms/it, loss 0.503239
Finished training it 1600/9593 of epoch 0, 4.73 ms/it, loss 0.500551
Finished training it 1700/9593 of epoch 0, 4.76 ms/it, loss 0.502948
Finished training it 1800/9593 of epoch 0, 4.82 ms/it, loss 0.497802
Finished training it 1900/9593 of epoch 0, 4.77 ms/it, loss 0.499544
Finished training it 2000/9593 of epoch 0, 4.75 ms/it, loss 0.499110
Finished training it 2100/9593 of epoch 0, 4.76 ms/it, loss 0.498483
Finished training it 2200/9593 of epoch 0, 4.71 ms/it, loss 0.496413
Finished training it 2300/9593 of epoch 0, 4.74 ms/it, loss 0.495164
Finished training it 2400/9593 of epoch 0, 4.74 ms/it, loss 0.494035
Finished training it 2500/9593 of epoch 0, 4.81 ms/it, loss 0.492026
Finished training it 2600/9593 of epoch 0, 4.77 ms/it, loss 0.492197
Finished training it 2700/9593 of epoch 0, 4.75 ms/it, loss 0.492864
Finished training it 2800/9593 of epoch 0, 4.62 ms/it, loss 0.491379
Finished training it 2900/9593 of epoch 0, 4.65 ms/it, loss 0.490827
Finished training it 3000/9593 of epoch 0, 4.77 ms/it, loss 0.488307
Finished training it 3100/9593 of epoch 0, 4.74 ms/it, loss 0.486746
Finished training it 3200/9593 of epoch 0, 4.90 ms/it, loss 0.488658
Finished training it 3300/9593 of epoch 0, 4.82 ms/it, loss 0.485903
Finished training it 3400/9593 of epoch 0, 5.45 ms/it, loss 0.485730
Finished training it 3500/9593 of epoch 0, 6.43 ms/it, loss 0.486413
Finished training it 3600/9593 of epoch 0, 6.58 ms/it, loss 0.484871
Finished training it 3700/9593 of epoch 0, 7.10 ms/it, loss 0.483092
Finished training it 3800/9593 of epoch 0, 6.38 ms/it, loss 0.482382
Finished training it 3900/9593 of epoch 0, 5.03 ms/it, loss 0.481949
Finished training it 4000/9593 of epoch 0, 5.13 ms/it, loss 0.482147
Finished training it 4100/9593 of epoch 0, 5.12 ms/it, loss 0.482046
Finished training it 4200/9593 of epoch 0, 4.99 ms/it, loss 0.480638
Finished training it 4300/9593 of epoch 0, 4.95 ms/it, loss 0.477945
Finished training it 4400/9593 of epoch 0, 6.63 ms/it, loss 0.480454
Finished training it 4500/9593 of epoch 0, 7.00 ms/it, loss 0.474965
Finished training it 4600/9593 of epoch 0, 7.14 ms/it, loss 0.477589
Finished training it 4700/9593 of epoch 0, 7.30 ms/it, loss 0.474632
Finished training it 4800/9593 of epoch 0, 7.09 ms/it, loss 0.474985
Finished training it 4900/9593 of epoch 0, 5.34 ms/it, loss 0.475474
Finished training it 5000/9593 of epoch 0, 5.04 ms/it, loss 0.474566
Finished training it 5100/9593 of epoch 0, 5.01 ms/it, loss 0.474963
Finished training it 5200/9593 of epoch 0, 5.26 ms/it, loss 0.473323
Finished training it 5300/9593 of epoch 0, 5.26 ms/it, loss 0.475415
Finished training it 5400/9593 of epoch 0, 6.17 ms/it, loss 0.471725
Finished training it 5500/9593 of epoch 0, 7.27 ms/it, loss 0.471795
Finished training it 5600/9593 of epoch 0, 7.41 ms/it, loss 0.472246
Finished training it 5700/9593 of epoch 0, 7.19 ms/it, loss 0.471938
Finished training it 5800/9593 of epoch 0, 6.75 ms/it, loss 0.473272
Finished training it 5900/9593 of epoch 0, 7.04 ms/it, loss 0.470619
Finished training it 6000/9593 of epoch 0, 6.86 ms/it, loss 0.470597
Finished training it 6100/9593 of epoch 0, 4.87 ms/it, loss 0.471942
Finished training it 6200/9593 of epoch 0, 4.94 ms/it, loss 0.471254
Finished training it 6300/9593 of epoch 0, 7.17 ms/it, loss 0.470398
Finished training it 6400/9593 of epoch 0, 7.19 ms/it, loss 0.467580
Finished training it 6500/9593 of epoch 0, 7.08 ms/it, loss 0.468232
Finished training it 6600/9593 of epoch 0, 5.85 ms/it, loss 0.468264
Finished training it 6700/9593 of epoch 0, 5.13 ms/it, loss 0.467036
Finished training it 6800/9593 of epoch 0, 4.97 ms/it, loss 0.468156
Finished training it 6900/9593 of epoch 0, 4.86 ms/it, loss 0.465884
Finished training it 7000/9593 of epoch 0, 4.90 ms/it, loss 0.468679
Finished training it 7100/9593 of epoch 0, 6.35 ms/it, loss 0.467596
Finished training it 7200/9593 of epoch 0, 7.32 ms/it, loss 0.465599
Finished training it 7300/9593 of epoch 0, 7.14 ms/it, loss 0.467790
Finished training it 7400/9593 of epoch 0, 5.18 ms/it, loss 0.468236
Finished training it 7500/9593 of epoch 0, 5.11 ms/it, loss 0.467792
Finished training it 7600/9593 of epoch 0, 5.35 ms/it, loss 0.465842
Finished training it 7700/9593 of epoch 0, 6.53 ms/it, loss 0.466068
Finished training it 7800/9593 of epoch 0, 7.38 ms/it, loss 0.465123
Finished training it 7900/9593 of epoch 0, 7.19 ms/it, loss 0.465861
Finished training it 8000/9593 of epoch 0, 7.30 ms/it, loss 0.465506
Finished training it 8100/9593 of epoch 0, 7.05 ms/it, loss 0.463832
Finished training it 8200/9593 of epoch 0, 7.17 ms/it, loss 0.465938
Finished training it 8300/9593 of epoch 0, 7.16 ms/it, loss 0.464583
Finished training it 8400/9593 of epoch 0, 7.61 ms/it, loss 0.465403
Finished training it 8500/9593 of epoch 0, 7.36 ms/it, loss 0.461282
Finished training it 8600/9593 of epoch 0, 5.25 ms/it, loss 0.466301
Finished training it 8700/9593 of epoch 0, 5.94 ms/it, loss 0.464443
Finished training it 8800/9593 of epoch 0, 7.21 ms/it, loss 0.464640
Finished training it 8900/9593 of epoch 0, 7.14 ms/it, loss 0.462900
Finished training it 9000/9593 of epoch 0, 7.39 ms/it, loss 0.462351
Finished training it 9100/9593 of epoch 0, 7.46 ms/it, loss 0.463574
Finished training it 9200/9593 of epoch 0, 7.23 ms/it, loss 0.463660
Finished training it 9300/9593 of epoch 0, 7.32 ms/it, loss 0.463295
Finished training it 9400/9593 of epoch 0, 6.94 ms/it, loss 0.463803
Finished training it 9500/9593 of epoch 0, 6.78 ms/it, loss 0.463589
Finished training it 9593/9593 of epoch 0, 7.14 ms/it, loss 0.463430
Time to train:  274.8994379043579
Finished iteration 1 for mini-batch size: 4096 and num-workers: 8


Running with num-workers: 12
Iteration 1 for mini-batch size 4096 and num-workers 12
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=4096 --num-workers=12 --use-gpu 2>&1 | tee run_kaggle_pt_batch_4096_workers_12_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/9593 of epoch 0, 9.59 ms/it, loss 0.558688
Finished training it 200/9593 of epoch 0, 7.69 ms/it, loss 0.522989
Finished training it 300/9593 of epoch 0, 7.80 ms/it, loss 0.517241
Finished training it 400/9593 of epoch 0, 8.24 ms/it, loss 0.515491
Finished training it 500/9593 of epoch 0, 8.25 ms/it, loss 0.514028
Finished training it 600/9593 of epoch 0, 7.87 ms/it, loss 0.512834
Finished training it 700/9593 of epoch 0, 8.04 ms/it, loss 0.511611
Finished training it 800/9593 of epoch 0, 8.65 ms/it, loss 0.509517
Finished training it 900/9593 of epoch 0, 8.42 ms/it, loss 0.506122
Finished training it 1000/9593 of epoch 0, 8.36 ms/it, loss 0.507110
Finished training it 1100/9593 of epoch 0, 8.55 ms/it, loss 0.506433
Finished training it 1200/9593 of epoch 0, 8.52 ms/it, loss 0.505112
Finished training it 1300/9593 of epoch 0, 8.50 ms/it, loss 0.505364
Finished training it 1400/9593 of epoch 0, 8.62 ms/it, loss 0.503347
Finished training it 1500/9593 of epoch 0, 8.34 ms/it, loss 0.503198
Finished training it 1600/9593 of epoch 0, 8.66 ms/it, loss 0.500625
Finished training it 1700/9593 of epoch 0, 8.65 ms/it, loss 0.503136
Finished training it 1800/9593 of epoch 0, 8.48 ms/it, loss 0.497892
Finished training it 1900/9593 of epoch 0, 8.78 ms/it, loss 0.499515
Finished training it 2000/9593 of epoch 0, 8.52 ms/it, loss 0.499168
Finished training it 2100/9593 of epoch 0, 8.19 ms/it, loss 0.498660
Finished training it 2200/9593 of epoch 0, 6.55 ms/it, loss 0.495750
Finished training it 2300/9593 of epoch 0, 6.99 ms/it, loss 0.495240
Finished training it 2400/9593 of epoch 0, 7.01 ms/it, loss 0.494218
Finished training it 2500/9593 of epoch 0, 8.59 ms/it, loss 0.492984
Finished training it 2600/9593 of epoch 0, 8.41 ms/it, loss 0.491644
Finished training it 2700/9593 of epoch 0, 7.45 ms/it, loss 0.493116
Finished training it 2800/9593 of epoch 0, 7.46 ms/it, loss 0.491495
Finished training it 2900/9593 of epoch 0, 7.69 ms/it, loss 0.491021
Finished training it 3000/9593 of epoch 0, 8.93 ms/it, loss 0.488380
Finished training it 3100/9593 of epoch 0, 8.84 ms/it, loss 0.486786
Finished training it 3200/9593 of epoch 0, 9.00 ms/it, loss 0.488833
Finished training it 3300/9593 of epoch 0, 8.50 ms/it, loss 0.485817
Finished training it 3400/9593 of epoch 0, 7.97 ms/it, loss 0.485583
Finished training it 3500/9593 of epoch 0, 7.40 ms/it, loss 0.487000
Finished training it 3600/9593 of epoch 0, 7.18 ms/it, loss 0.484784
Finished training it 3700/9593 of epoch 0, 8.78 ms/it, loss 0.483122
Finished training it 3800/9593 of epoch 0, 8.61 ms/it, loss 0.482443
Finished training it 3900/9593 of epoch 0, 8.08 ms/it, loss 0.482007
Finished training it 4000/9593 of epoch 0, 8.52 ms/it, loss 0.482147
Finished training it 4100/9593 of epoch 0, 8.59 ms/it, loss 0.482034
Finished training it 4200/9593 of epoch 0, 8.51 ms/it, loss 0.480637
Finished training it 4300/9593 of epoch 0, 8.95 ms/it, loss 0.477935
Finished training it 4400/9593 of epoch 0, 8.82 ms/it, loss 0.480368
Finished training it 4500/9593 of epoch 0, 8.52 ms/it, loss 0.474923
Finished training it 4600/9593 of epoch 0, 8.53 ms/it, loss 0.478050
Finished training it 4700/9593 of epoch 0, 8.39 ms/it, loss 0.474470
Finished training it 4800/9593 of epoch 0, 8.40 ms/it, loss 0.474962
Finished training it 4900/9593 of epoch 0, 8.45 ms/it, loss 0.475411
Finished training it 5000/9593 of epoch 0, 7.87 ms/it, loss 0.474500
Finished training it 5100/9593 of epoch 0, 7.84 ms/it, loss 0.474954
Finished training it 5200/9593 of epoch 0, 9.20 ms/it, loss 0.472753
Finished training it 5300/9593 of epoch 0, 7.68 ms/it, loss 0.475962
Finished training it 5400/9593 of epoch 0, 8.02 ms/it, loss 0.471807
Finished training it 5500/9593 of epoch 0, 8.24 ms/it, loss 0.472479
Finished training it 5600/9593 of epoch 0, 8.40 ms/it, loss 0.471551
Finished training it 5700/9593 of epoch 0, 8.81 ms/it, loss 0.471914
Finished training it 5800/9593 of epoch 0, 8.68 ms/it, loss 0.473331
Finished training it 5900/9593 of epoch 0, 8.53 ms/it, loss 0.470625
Finished training it 6000/9593 of epoch 0, 8.89 ms/it, loss 0.470606
Finished training it 6100/9593 of epoch 0, 8.56 ms/it, loss 0.471895
Finished training it 6200/9593 of epoch 0, 7.85 ms/it, loss 0.471177
Finished training it 6300/9593 of epoch 0, 7.39 ms/it, loss 0.470436
Finished training it 6400/9593 of epoch 0, 8.63 ms/it, loss 0.467601
Finished training it 6500/9593 of epoch 0, 7.50 ms/it, loss 0.468344
Finished training it 6600/9593 of epoch 0, 8.38 ms/it, loss 0.468322
Finished training it 6700/9593 of epoch 0, 8.19 ms/it, loss 0.467126
Finished training it 6800/9593 of epoch 0, 8.42 ms/it, loss 0.468073
Finished training it 6900/9593 of epoch 0, 8.37 ms/it, loss 0.465887
Finished training it 7000/9593 of epoch 0, 8.75 ms/it, loss 0.468822
Finished training it 7100/9593 of epoch 0, 8.26 ms/it, loss 0.467524
Finished training it 7200/9593 of epoch 0, 8.79 ms/it, loss 0.465606
Finished training it 7300/9593 of epoch 0, 7.96 ms/it, loss 0.467955
Finished training it 7400/9593 of epoch 0, 8.12 ms/it, loss 0.468335
Finished training it 7500/9593 of epoch 0, 7.73 ms/it, loss 0.467844
Finished training it 7600/9593 of epoch 0, 7.95 ms/it, loss 0.465933
Finished training it 7700/9593 of epoch 0, 8.08 ms/it, loss 0.466086
Finished training it 7800/9593 of epoch 0, 8.86 ms/it, loss 0.465190
Finished training it 7900/9593 of epoch 0, 7.86 ms/it, loss 0.465916
Finished training it 8000/9593 of epoch 0, 7.82 ms/it, loss 0.465624
Finished training it 8100/9593 of epoch 0, 7.54 ms/it, loss 0.463882
Finished training it 8200/9593 of epoch 0, 9.02 ms/it, loss 0.466016
Finished training it 8300/9593 of epoch 0, 8.83 ms/it, loss 0.464651
Finished training it 8400/9593 of epoch 0, 9.34 ms/it, loss 0.465523
Finished training it 8500/9593 of epoch 0, 8.21 ms/it, loss 0.461492
Finished training it 8600/9593 of epoch 0, 8.47 ms/it, loss 0.466154
Finished training it 8700/9593 of epoch 0, 8.43 ms/it, loss 0.464567
Finished training it 8800/9593 of epoch 0, 8.90 ms/it, loss 0.464751
Finished training it 8900/9593 of epoch 0, 8.20 ms/it, loss 0.462984
Finished training it 9000/9593 of epoch 0, 8.12 ms/it, loss 0.462350
Finished training it 9100/9593 of epoch 0, 8.91 ms/it, loss 0.463679
Finished training it 9200/9593 of epoch 0, 7.23 ms/it, loss 0.463773
Finished training it 9300/9593 of epoch 0, 6.74 ms/it, loss 0.463547
Finished training it 9400/9593 of epoch 0, 8.58 ms/it, loss 0.463911
Finished training it 9500/9593 of epoch 0, 8.66 ms/it, loss 0.463668
Finished training it 9593/9593 of epoch 0, 8.91 ms/it, loss 0.463565
Time to train:  396.7519052028656
Finished iteration 1 for mini-batch size: 4096 and num-workers: 12


Running with mini-batch size: 8192
Running with num-workers: 4
Iteration 1 for mini-batch size 8192 and num-workers 4
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=8192 --num-workers=4 --use-gpu 2>&1 | tee run_kaggle_pt_batch_8192_workers_4_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/4797 of epoch 0, 10.82 ms/it, loss 0.558241
Finished training it 200/4797 of epoch 0, 9.32 ms/it, loss 0.522888
Finished training it 300/4797 of epoch 0, 8.95 ms/it, loss 0.518064
Finished training it 400/4797 of epoch 0, 9.22 ms/it, loss 0.515222
Finished training it 500/4797 of epoch 0, 8.80 ms/it, loss 0.513788
Finished training it 600/4797 of epoch 0, 9.74 ms/it, loss 0.512495
Finished training it 700/4797 of epoch 0, 9.57 ms/it, loss 0.511484
Finished training it 800/4797 of epoch 0, 10.03 ms/it, loss 0.510079
Finished training it 900/4797 of epoch 0, 9.55 ms/it, loss 0.507469
Finished training it 1000/4797 of epoch 0, 9.95 ms/it, loss 0.507553
Finished training it 1100/4797 of epoch 0, 9.80 ms/it, loss 0.506871
Finished training it 1200/4797 of epoch 0, 8.97 ms/it, loss 0.504583
Finished training it 1300/4797 of epoch 0, 9.46 ms/it, loss 0.503971
Finished training it 1400/4797 of epoch 0, 10.04 ms/it, loss 0.503045
Finished training it 1500/4797 of epoch 0, 10.54 ms/it, loss 0.502221
Finished training it 1600/4797 of epoch 0, 9.99 ms/it, loss 0.501257
Finished training it 1700/4797 of epoch 0, 9.54 ms/it, loss 0.500662
Finished training it 1800/4797 of epoch 0, 9.96 ms/it, loss 0.500453
Finished training it 1900/4797 of epoch 0, 9.63 ms/it, loss 0.499126
Finished training it 2000/4797 of epoch 0, 9.92 ms/it, loss 0.498690
Finished training it 2100/4797 of epoch 0, 9.63 ms/it, loss 0.497194
Finished training it 2200/4797 of epoch 0, 9.95 ms/it, loss 0.496156
Finished training it 2300/4797 of epoch 0, 9.82 ms/it, loss 0.495227
Finished training it 2400/4797 of epoch 0, 9.38 ms/it, loss 0.493593
Finished training it 2500/4797 of epoch 0, 9.33 ms/it, loss 0.492672
Finished training it 2600/4797 of epoch 0, 9.36 ms/it, loss 0.493666
Finished training it 2700/4797 of epoch 0, 9.47 ms/it, loss 0.491505
Finished training it 2800/4797 of epoch 0, 10.09 ms/it, loss 0.490152
Finished training it 2900/4797 of epoch 0, 9.47 ms/it, loss 0.489803
Finished training it 3000/4797 of epoch 0, 9.50 ms/it, loss 0.488196
Finished training it 3100/4797 of epoch 0, 9.99 ms/it, loss 0.489197
Finished training it 3200/4797 of epoch 0, 10.08 ms/it, loss 0.486377
Finished training it 3300/4797 of epoch 0, 9.84 ms/it, loss 0.485163
Finished training it 3400/4797 of epoch 0, 9.45 ms/it, loss 0.485605
Finished training it 3500/4797 of epoch 0, 10.46 ms/it, loss 0.483232
Finished training it 3600/4797 of epoch 0, 9.72 ms/it, loss 0.484152
Finished training it 3700/4797 of epoch 0, 9.28 ms/it, loss 0.484397
Finished training it 3800/4797 of epoch 0, 9.21 ms/it, loss 0.483222
Finished training it 3900/4797 of epoch 0, 9.29 ms/it, loss 0.480467
Finished training it 4000/4797 of epoch 0, 9.84 ms/it, loss 0.481672
Finished training it 4100/4797 of epoch 0, 9.74 ms/it, loss 0.480575
Finished training it 4200/4797 of epoch 0, 9.62 ms/it, loss 0.480272
Finished training it 4300/4797 of epoch 0, 10.59 ms/it, loss 0.478582
Finished training it 4400/4797 of epoch 0, 10.09 ms/it, loss 0.478427
Finished training it 4500/4797 of epoch 0, 9.89 ms/it, loss 0.477351
Finished training it 4600/4797 of epoch 0, 9.56 ms/it, loss 0.477477
Finished training it 4700/4797 of epoch 0, 9.63 ms/it, loss 0.477843
Finished training it 4797/4797 of epoch 0, 9.94 ms/it, loss 0.476958
Time to train:  557.0664732456207
Finished iteration 1 for mini-batch size: 8192 and num-workers: 4


Running with num-workers: 8
Iteration 1 for mini-batch size 8192 and num-workers 8
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=8192 --num-workers=8 --use-gpu 2>&1 | tee run_kaggle_pt_batch_8192_workers_8_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/4797 of epoch 0, 10.77 ms/it, loss 0.558241
Finished training it 200/4797 of epoch 0, 8.05 ms/it, loss 0.522888
Finished training it 300/4797 of epoch 0, 8.63 ms/it, loss 0.518064
Finished training it 400/4797 of epoch 0, 8.63 ms/it, loss 0.515222
Finished training it 500/4797 of epoch 0, 9.27 ms/it, loss 0.513787
Finished training it 600/4797 of epoch 0, 8.95 ms/it, loss 0.512509
Finished training it 700/4797 of epoch 0, 8.78 ms/it, loss 0.511480
Finished training it 800/4797 of epoch 0, 8.29 ms/it, loss 0.510076
Finished training it 900/4797 of epoch 0, 8.96 ms/it, loss 0.507464
Finished training it 1000/4797 of epoch 0, 8.70 ms/it, loss 0.507573
Finished training it 1100/4797 of epoch 0, 8.62 ms/it, loss 0.506872
Finished training it 1200/4797 of epoch 0, 8.75 ms/it, loss 0.504589
Finished training it 1300/4797 of epoch 0, 10.49 ms/it, loss 0.503963
Finished training it 1400/4797 of epoch 0, 10.37 ms/it, loss 0.503049
Finished training it 1500/4797 of epoch 0, 10.22 ms/it, loss 0.502212
Finished training it 1600/4797 of epoch 0, 9.68 ms/it, loss 0.501258
Finished training it 1700/4797 of epoch 0, 9.81 ms/it, loss 0.500669
Finished training it 1800/4797 of epoch 0, 10.23 ms/it, loss 0.500454
Finished training it 1900/4797 of epoch 0, 9.65 ms/it, loss 0.499134
Finished training it 2000/4797 of epoch 0, 9.28 ms/it, loss 0.498702
Finished training it 2100/4797 of epoch 0, 9.82 ms/it, loss 0.497183
Finished training it 2200/4797 of epoch 0, 9.85 ms/it, loss 0.496178
Finished training it 2300/4797 of epoch 0, 9.74 ms/it, loss 0.495201
Finished training it 2400/4797 of epoch 0, 9.75 ms/it, loss 0.493576
Finished training it 2500/4797 of epoch 0, 10.09 ms/it, loss 0.492667
Finished training it 2600/4797 of epoch 0, 10.02 ms/it, loss 0.493650
Finished training it 2700/4797 of epoch 0, 9.99 ms/it, loss 0.491508
Finished training it 2800/4797 of epoch 0, 9.69 ms/it, loss 0.490147
Finished training it 2900/4797 of epoch 0, 9.35 ms/it, loss 0.489791
Finished training it 3000/4797 of epoch 0, 10.05 ms/it, loss 0.488169
Finished training it 3100/4797 of epoch 0, 9.68 ms/it, loss 0.489098
Finished training it 3200/4797 of epoch 0, 10.08 ms/it, loss 0.486378
Finished training it 3300/4797 of epoch 0, 10.57 ms/it, loss 0.485129
Finished training it 3400/4797 of epoch 0, 9.85 ms/it, loss 0.485627
Finished training it 3500/4797 of epoch 0, 10.57 ms/it, loss 0.483109
Finished training it 3600/4797 of epoch 0, 9.57 ms/it, loss 0.484168
Finished training it 3700/4797 of epoch 0, 9.29 ms/it, loss 0.484288
Finished training it 3800/4797 of epoch 0, 10.13 ms/it, loss 0.483150
Finished training it 3900/4797 of epoch 0, 10.40 ms/it, loss 0.480459
Finished training it 4000/4797 of epoch 0, 9.89 ms/it, loss 0.481620
Finished training it 4100/4797 of epoch 0, 9.74 ms/it, loss 0.480514
Finished training it 4200/4797 of epoch 0, 10.10 ms/it, loss 0.480248
Finished training it 4300/4797 of epoch 0, 9.12 ms/it, loss 0.478533
Finished training it 4400/4797 of epoch 0, 9.22 ms/it, loss 0.478463
Finished training it 4500/4797 of epoch 0, 9.87 ms/it, loss 0.477388
Finished training it 4600/4797 of epoch 0, 10.16 ms/it, loss 0.477326
Finished training it 4700/4797 of epoch 0, 10.09 ms/it, loss 0.477809
Finished training it 4797/4797 of epoch 0, 9.14 ms/it, loss 0.476956
Time to train:  573.6500144004822
Finished iteration 1 for mini-batch size: 8192 and num-workers: 8


Running with num-workers: 12
Iteration 1 for mini-batch size 8192 and num-workers 12
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=8192 --num-workers=12 --use-gpu 2>&1 | tee run_kaggle_pt_batch_8192_workers_12_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/4797 of epoch 0, 10.26 ms/it, loss 0.558241
Finished training it 200/4797 of epoch 0, 8.43 ms/it, loss 0.522889
Finished training it 300/4797 of epoch 0, 8.62 ms/it, loss 0.518064
Finished training it 400/4797 of epoch 0, 8.42 ms/it, loss 0.515222
Finished training it 500/4797 of epoch 0, 8.47 ms/it, loss 0.513790
Finished training it 600/4797 of epoch 0, 8.99 ms/it, loss 0.512500
Finished training it 700/4797 of epoch 0, 8.47 ms/it, loss 0.511481
Finished training it 800/4797 of epoch 0, 9.16 ms/it, loss 0.510095
Finished training it 900/4797 of epoch 0, 9.80 ms/it, loss 0.507516
Finished training it 1000/4797 of epoch 0, 9.61 ms/it, loss 0.507558
Finished training it 1100/4797 of epoch 0, 9.58 ms/it, loss 0.506894
Finished training it 1200/4797 of epoch 0, 8.86 ms/it, loss 0.504567
Finished training it 1300/4797 of epoch 0, 9.84 ms/it, loss 0.503967
Finished training it 1400/4797 of epoch 0, 9.94 ms/it, loss 0.503036
Finished training it 1500/4797 of epoch 0, 9.00 ms/it, loss 0.502221
Finished training it 1600/4797 of epoch 0, 8.28 ms/it, loss 0.501264
Finished training it 1700/4797 of epoch 0, 8.06 ms/it, loss 0.500664
Finished training it 1800/4797 of epoch 0, 8.39 ms/it, loss 0.500459
Finished training it 1900/4797 of epoch 0, 8.04 ms/it, loss 0.499128
Finished training it 2000/4797 of epoch 0, 8.59 ms/it, loss 0.498691
Finished training it 2100/4797 of epoch 0, 8.38 ms/it, loss 0.497200
Finished training it 2200/4797 of epoch 0, 9.37 ms/it, loss 0.496149
Finished training it 2300/4797 of epoch 0, 9.78 ms/it, loss 0.495248
Finished training it 2400/4797 of epoch 0, 8.98 ms/it, loss 0.493604
Finished training it 2500/4797 of epoch 0, 8.09 ms/it, loss 0.492669
Finished training it 2600/4797 of epoch 0, 8.50 ms/it, loss 0.493674
Finished training it 2700/4797 of epoch 0, 8.90 ms/it, loss 0.491498
Finished training it 2800/4797 of epoch 0, 8.92 ms/it, loss 0.490156
Finished training it 2900/4797 of epoch 0, 8.52 ms/it, loss 0.489806
Finished training it 3000/4797 of epoch 0, 8.55 ms/it, loss 0.488213
Finished training it 3100/4797 of epoch 0, 8.27 ms/it, loss 0.489205
Finished training it 3200/4797 of epoch 0, 8.48 ms/it, loss 0.486390
Finished training it 3300/4797 of epoch 0, 8.12 ms/it, loss 0.485165
Finished training it 3400/4797 of epoch 0, 8.43 ms/it, loss 0.485591
Finished training it 3500/4797 of epoch 0, 8.35 ms/it, loss 0.483255
Finished training it 3600/4797 of epoch 0, 8.10 ms/it, loss 0.484135
Finished training it 3700/4797 of epoch 0, 8.54 ms/it, loss 0.484401
Finished training it 3800/4797 of epoch 0, 8.10 ms/it, loss 0.483225
Finished training it 3900/4797 of epoch 0, 8.49 ms/it, loss 0.480483
Finished training it 4000/4797 of epoch 0, 8.32 ms/it, loss 0.481691
Finished training it 4100/4797 of epoch 0, 8.84 ms/it, loss 0.480554
Finished training it 4200/4797 of epoch 0, 8.54 ms/it, loss 0.480288
Finished training it 4300/4797 of epoch 0, 7.77 ms/it, loss 0.478580
Finished training it 4400/4797 of epoch 0, 8.35 ms/it, loss 0.478430
Finished training it 4500/4797 of epoch 0, 8.87 ms/it, loss 0.477318
Finished training it 4600/4797 of epoch 0, 8.68 ms/it, loss 0.477499
Finished training it 4700/4797 of epoch 0, 8.80 ms/it, loss 0.477846
Finished training it 4797/4797 of epoch 0, 8.19 ms/it, loss 0.476965
Time to train:  590.2377045154572
Finished iteration 1 for mini-batch size: 8192 and num-workers: 12


Running with mini-batch size: 16384
Running with num-workers: 4
Iteration 1 for mini-batch size 16384 and num-workers 4
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=16384 --num-workers=4 --use-gpu 2>&1 | tee run_kaggle_pt_batch_16384_workers_4_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/2399 of epoch 0, 16.50 ms/it, loss 0.558139
Finished training it 200/2399 of epoch 0, 14.35 ms/it, loss 0.523325
Finished training it 300/2399 of epoch 0, 13.89 ms/it, loss 0.517496
Finished training it 400/2399 of epoch 0, 14.56 ms/it, loss 0.515406
Finished training it 500/2399 of epoch 0, 14.38 ms/it, loss 0.514217
Finished training it 600/2399 of epoch 0, 14.83 ms/it, loss 0.513022
Finished training it 700/2399 of epoch 0, 14.32 ms/it, loss 0.511075
Finished training it 800/2399 of epoch 0, 14.07 ms/it, loss 0.509128
Finished training it 900/2399 of epoch 0, 14.03 ms/it, loss 0.508497
Finished training it 1000/2399 of epoch 0, 14.90 ms/it, loss 0.507086
Finished training it 1100/2399 of epoch 0, 14.05 ms/it, loss 0.506493
Finished training it 1200/2399 of epoch 0, 14.64 ms/it, loss 0.503847
Finished training it 1300/2399 of epoch 0, 14.33 ms/it, loss 0.503757
Finished training it 1400/2399 of epoch 0, 14.36 ms/it, loss 0.503044
Finished training it 1500/2399 of epoch 0, 14.98 ms/it, loss 0.501455
Finished training it 1600/2399 of epoch 0, 14.38 ms/it, loss 0.502045
Finished training it 1700/2399 of epoch 0, 14.39 ms/it, loss 0.499942
Finished training it 1800/2399 of epoch 0, 14.21 ms/it, loss 0.499572
Finished training it 1900/2399 of epoch 0, 14.63 ms/it, loss 0.498856
Finished training it 2000/2399 of epoch 0, 14.36 ms/it, loss 0.497709
Finished training it 2100/2399 of epoch 0, 14.19 ms/it, loss 0.496950
Finished training it 2200/2399 of epoch 0, 14.16 ms/it, loss 0.496854
Finished training it 2300/2399 of epoch 0, 14.49 ms/it, loss 0.494198
Finished training it 2399/2399 of epoch 0, 14.27 ms/it, loss 0.494746
Time to train:  627.31485247612
Finished iteration 1 for mini-batch size: 16384 and num-workers: 4


Running with num-workers: 8
Iteration 1 for mini-batch size 16384 and num-workers 8
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=16384 --num-workers=8 --use-gpu 2>&1 | tee run_kaggle_pt_batch_16384_workers_8_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/2399 of epoch 0, 16.38 ms/it, loss 0.558139
Finished training it 200/2399 of epoch 0, 14.62 ms/it, loss 0.523325
Finished training it 300/2399 of epoch 0, 14.07 ms/it, loss 0.517496
Finished training it 400/2399 of epoch 0, 13.53 ms/it, loss 0.515405
Finished training it 500/2399 of epoch 0, 13.54 ms/it, loss 0.514215
Finished training it 600/2399 of epoch 0, 13.58 ms/it, loss 0.513018
Finished training it 700/2399 of epoch 0, 13.59 ms/it, loss 0.511078
Finished training it 800/2399 of epoch 0, 13.58 ms/it, loss 0.509127
Finished training it 900/2399 of epoch 0, 13.27 ms/it, loss 0.508491
Finished training it 1000/2399 of epoch 0, 13.50 ms/it, loss 0.507083
Finished training it 1100/2399 of epoch 0, 13.40 ms/it, loss 0.506487
Finished training it 1200/2399 of epoch 0, 14.21 ms/it, loss 0.503847
Finished training it 1300/2399 of epoch 0, 14.04 ms/it, loss 0.503758
Finished training it 1400/2399 of epoch 0, 13.70 ms/it, loss 0.503043
Finished training it 1500/2399 of epoch 0, 13.73 ms/it, loss 0.501458
Finished training it 1600/2399 of epoch 0, 14.18 ms/it, loss 0.502042
Finished training it 1700/2399 of epoch 0, 14.32 ms/it, loss 0.499802
Finished training it 1800/2399 of epoch 0, 14.13 ms/it, loss 0.499679
Finished training it 1900/2399 of epoch 0, 14.36 ms/it, loss 0.498831
Finished training it 2000/2399 of epoch 0, 13.90 ms/it, loss 0.497730
Finished training it 2100/2399 of epoch 0, 13.85 ms/it, loss 0.496945
Finished training it 2200/2399 of epoch 0, 13.97 ms/it, loss 0.496867
Finished training it 2300/2399 of epoch 0, 13.57 ms/it, loss 0.494199
Finished training it 2399/2399 of epoch 0, 13.34 ms/it, loss 0.494763
Time to train:  715.5956201553345
Finished iteration 1 for mini-batch size: 16384 and num-workers: 8


Running with num-workers: 12
Iteration 1 for mini-batch size 16384 and num-workers 12
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=16384 --num-workers=12 --use-gpu 2>&1 | tee run_kaggle_pt_batch_16384_workers_12_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/2399 of epoch 0, 16.00 ms/it, loss 0.558139
Finished training it 200/2399 of epoch 0, 13.28 ms/it, loss 0.523325
Finished training it 300/2399 of epoch 0, 13.86 ms/it, loss 0.517496
Finished training it 400/2399 of epoch 0, 13.60 ms/it, loss 0.515406
Finished training it 500/2399 of epoch 0, 13.21 ms/it, loss 0.514218
Finished training it 600/2399 of epoch 0, 13.78 ms/it, loss 0.513020
Finished training it 700/2399 of epoch 0, 14.70 ms/it, loss 0.511075
Finished training it 800/2399 of epoch 0, 13.94 ms/it, loss 0.509134
Finished training it 900/2399 of epoch 0, 13.19 ms/it, loss 0.508478
Finished training it 1000/2399 of epoch 0, 13.81 ms/it, loss 0.507103
Finished training it 1100/2399 of epoch 0, 13.27 ms/it, loss 0.506483
Finished training it 1200/2399 of epoch 0, 13.26 ms/it, loss 0.503853
Finished training it 1300/2399 of epoch 0, 13.52 ms/it, loss 0.503748
Finished training it 1400/2399 of epoch 0, 13.70 ms/it, loss 0.503047
Finished training it 1500/2399 of epoch 0, 13.80 ms/it, loss 0.501466
Finished training it 1600/2399 of epoch 0, 13.65 ms/it, loss 0.502028
Finished training it 1700/2399 of epoch 0, 13.75 ms/it, loss 0.500157
Finished training it 1800/2399 of epoch 0, 13.59 ms/it, loss 0.499588
Finished training it 1900/2399 of epoch 0, 14.27 ms/it, loss 0.498404
Finished training it 2000/2399 of epoch 0, 13.87 ms/it, loss 0.497995
Finished training it 2100/2399 of epoch 0, 13.26 ms/it, loss 0.496697
Finished training it 2200/2399 of epoch 0, 13.28 ms/it, loss 0.496917
Finished training it 2300/2399 of epoch 0, 12.90 ms/it, loss 0.494228
Finished training it 2399/2399 of epoch 0, 13.12 ms/it, loss 0.494760
Time to train:  775.436928987503
Finished iteration 1 for mini-batch size: 16384 and num-workers: 12


Running with mini-batch size: 32768
Running with num-workers: 4
Iteration 1 for mini-batch size 32768 and num-workers 4
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=32768 --num-workers=4 --use-gpu 2>&1 | tee run_kaggle_pt_batch_32768_workers_4_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/1200 of epoch 0, 28.42 ms/it, loss 0.558437
Finished training it 200/1200 of epoch 0, 25.93 ms/it, loss 0.523252
Finished training it 300/1200 of epoch 0, 25.69 ms/it, loss 0.518108
Finished training it 400/1200 of epoch 0, 25.49 ms/it, loss 0.514862
Finished training it 500/1200 of epoch 0, 25.75 ms/it, loss 0.514674
Finished training it 600/1200 of epoch 0, 26.05 ms/it, loss 0.512520
Finished training it 700/1200 of epoch 0, 25.51 ms/it, loss 0.510182
Finished training it 800/1200 of epoch 0, 25.64 ms/it, loss 0.510056
Finished training it 900/1200 of epoch 0, 25.42 ms/it, loss 0.506954
Finished training it 1000/1200 of epoch 0, 25.64 ms/it, loss 0.507521
Finished training it 1100/1200 of epoch 0, 26.05 ms/it, loss 0.506210
Finished training it 1200/1200 of epoch 0, 26.86 ms/it, loss 0.504959
Time to train:  811.1468486785889
Finished iteration 1 for mini-batch size: 32768 and num-workers: 4


Running with num-workers: 8
Iteration 1 for mini-batch size 32768 and num-workers 8
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=32768 --num-workers=8 --use-gpu 2>&1 | tee run_kaggle_pt_batch_32768_workers_8_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/1200 of epoch 0, 30.70 ms/it, loss 0.558436
Finished training it 200/1200 of epoch 0, 25.72 ms/it, loss 0.523252
Finished training it 300/1200 of epoch 0, 25.34 ms/it, loss 0.518108
Finished training it 400/1200 of epoch 0, 25.56 ms/it, loss 0.514862
Finished training it 500/1200 of epoch 0, 25.45 ms/it, loss 0.514674
Finished training it 600/1200 of epoch 0, 24.95 ms/it, loss 0.512519
Finished training it 700/1200 of epoch 0, 24.82 ms/it, loss 0.510180
Finished training it 800/1200 of epoch 0, 24.81 ms/it, loss 0.510055
Finished training it 900/1200 of epoch 0, 25.03 ms/it, loss 0.507008
Finished training it 1000/1200 of epoch 0, 24.33 ms/it, loss 0.507431
Finished training it 1100/1200 of epoch 0, 24.51 ms/it, loss 0.506274
Finished training it 1200/1200 of epoch 0, 24.89 ms/it, loss 0.504929
Time to train:  823.1713080406189
Finished iteration 1 for mini-batch size: 32768 and num-workers: 8


Running with num-workers: 12
Iteration 1 for mini-batch size 32768 and num-workers 12
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=32768 --num-workers=12 --use-gpu 2>&1 | tee run_kaggle_pt_batch_32768_workers_12_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/1200 of epoch 0, 25.36 ms/it, loss 0.558437
Finished training it 200/1200 of epoch 0, 24.33 ms/it, loss 0.523252
Finished training it 300/1200 of epoch 0, 24.63 ms/it, loss 0.518108
Finished training it 400/1200 of epoch 0, 25.41 ms/it, loss 0.514862
Finished training it 500/1200 of epoch 0, 25.18 ms/it, loss 0.514674
Finished training it 600/1200 of epoch 0, 24.65 ms/it, loss 0.512518
Finished training it 700/1200 of epoch 0, 24.79 ms/it, loss 0.510178
Finished training it 800/1200 of epoch 0, 24.59 ms/it, loss 0.510060
Finished training it 900/1200 of epoch 0, 24.25 ms/it, loss 0.507072
Finished training it 1000/1200 of epoch 0, 24.60 ms/it, loss 0.507359
Finished training it 1100/1200 of epoch 0, 24.88 ms/it, loss 0.506256
Finished training it 1200/1200 of epoch 0, 23.89 ms/it, loss 0.504948
Time to train:  873.1634292602539
Finished iteration 1 for mini-batch size: 32768 and num-workers: 12


Running with mini-batch size: 65536
Running with num-workers: 4
Iteration 1 for mini-batch size 65536 and num-workers 4
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=65536 --num-workers=4 --use-gpu 2>&1 | tee run_kaggle_pt_batch_65536_workers_4_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/600 of epoch 0, 49.59 ms/it, loss 0.558548
Finished training it 200/600 of epoch 0, 46.01 ms/it, loss 0.523382
Finished training it 300/600 of epoch 0, 46.67 ms/it, loss 0.517802
Finished training it 400/600 of epoch 0, 46.90 ms/it, loss 0.514681
Finished training it 500/600 of epoch 0, 46.83 ms/it, loss 0.514538
Finished training it 600/600 of epoch 0, 45.92 ms/it, loss 0.512254
Time to train:  819.6055946350098
Finished iteration 1 for mini-batch size: 65536 and num-workers: 4


Running with num-workers: 8
Iteration 1 for mini-batch size 65536 and num-workers 8
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=65536 --num-workers=8 --use-gpu 2>&1 | tee run_kaggle_pt_batch_65536_workers_8_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/600 of epoch 0, 47.61 ms/it, loss 0.558548
Finished training it 200/600 of epoch 0, 45.35 ms/it, loss 0.523382
Finished training it 300/600 of epoch 0, 45.11 ms/it, loss 0.517802
Finished training it 400/600 of epoch 0, 44.93 ms/it, loss 0.514681
Finished training it 500/600 of epoch 0, 45.91 ms/it, loss 0.514538
Finished training it 600/600 of epoch 0, 45.01 ms/it, loss 0.512255
Time to train:  719.7647683620453
Finished iteration 1 for mini-batch size: 65536 and num-workers: 8


Running with num-workers: 12
Iteration 1 for mini-batch size 65536 and num-workers 12
CUDA_VISIBLE_DEVICES=0 python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/train.txt --processed-data-file=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz --loss-function=bce --round-targets=True --learning-rate=0.1 --print-freq=100 --print-time --mini-batch-size=65536 --num-workers=12 --use-gpu 2>&1 | tee run_kaggle_pt_batch_65536_workers_12_iter_1.log
world size: 1, current rank: 0, local rank: 0
Using 1 GPU(s)...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yuzhuyu/u55c/criteo_sharded/train_1/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
time/loss/accuracy (if enabled):
Finished training it 100/600 of epoch 0, 46.97 ms/it, loss 0.558548
Finished training it 200/600 of epoch 0, 45.97 ms/it, loss 0.523382
Finished training it 300/600 of epoch 0, 45.70 ms/it, loss 0.517802
Finished training it 400/600 of epoch 0, 46.02 ms/it, loss 0.514681
Finished training it 500/600 of epoch 0, 45.60 ms/it, loss 0.514538
Finished training it 600/600 of epoch 0, 45.94 ms/it, loss 0.512255
Time to train:  877.1216187477112
Finished iteration 1 for mini-batch size: 65536 and num-workers: 12


done
done
